Imports System.IO
Imports DinkToPdf
Imports DinkToPdf.Contracts

Public Class GeneratePDF
    Inherits System.Web.UI.Page

    Protected Sub btnGeneratePDF_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnGeneratePDF.Click
        Dim converter = New SynchronizedConverter(New PdfTools())
        Dim htmlTable As String = GetHtmlTable() ' Replace with your HTML table content

        Dim doc = New HtmlToPdfDocument() With {
            .GlobalSettings = {
                .PaperSize = PaperKind.A4,
                .Orientation = Orientation.Portrait
            },
            .Objects = {
                New ObjectSettings() With {
                    .PagesCount = True,
                    .HtmlContent = htmlTable
                }
            }
        }

        Dim pdfBytes As Byte() = converter.Convert(doc)

        ' Create a MemoryStream to store the PDF
        Using pdfStream As New MemoryStream(pdfBytes)
            ' Provide the PDF for download
            Response.Clear()
            Response.ContentType = "application/pdf"
            Response.AddHeader("content-disposition", "attachment;filename=table.pdf")
            Response.Buffer = True
            Response.OutputStream.Write(pdfStream.GetBuffer(), 0, pdfStream.GetBuffer().Length)
            Response.OutputStream.Flush()
            Response.End()
        End Using
    End Sub

    Private Function GetHtmlTable() As String
        ' Replace this function with your HTML table content
        Return "<table border='1'><tr><th>Name</th><th>Age</th></tr><tr><td>John</td><td>30</td></tr><tr><td>Alice</td><td>25</td></tr></table>"
    End Function
End Class
