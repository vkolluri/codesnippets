Shared Function GenerateHtmlTable(data As Object) As String
        If data Is Nothing Then
            Return String.Empty
        End If

        Dim html As New StringBuilder()
        html.AppendLine("<table class='table table-bordered table-striped'>")

        Dim objectType As Type = data.GetType()

        ' Check if it's an anonymous type (e.g., JObject)
        If objectType.Name.Contains("<>") AndAlso objectType.Name.Contains("AnonymousType") Then
            Dim jObject As JObject = JObject.FromObject(data)

            For Each [property] As JProperty In jObject.Properties()
                html.AppendLine("<tr>")
                html.AppendLine($"<th>{[property].Name}</th>")
                html.AppendLine("<td>")

                Dim childHtml As String = GenerateHtmlTable([property].Value)
                html.AppendLine(childHtml)

                html.AppendLine("</td>")
                html.AppendLine("</tr>")
            Next
        Else
            ' Display properties and values of the object
            Dim properties As PropertyInfo() = objectType.GetProperties()

            For Each [property] As PropertyInfo In properties
                html.AppendLine("<tr>")
                html.AppendLine($"<th>{[property].Name}</th>")
                html.AppendLine("<td>")

                Dim value As Object = [property].GetValue(data)
                Dim childHtml As String = GenerateHtmlTable(value)
                html.AppendLine(childHtml)

                html.AppendLine("</td>")
                html.AppendLine("</tr>")
            Next
        End If

        html.AppendLine("</table>")
        Return html.ToString()
    End Function
