-- Declare the table variable to hold the processed column names
DECLARE @Columns NVARCHAR(MAX) = '';

-- Add your raw header data (comma-separated values)
DECLARE @Header NVARCHAR(MAX) = 'Column1/Column2 #Column3(Column4)';  -- Replace with your actual CSV header

-- Replace spaces and special characters
SET @Header = REPLACE(@Header, ' ', '_');
SET @Header = REPLACE(@Header, '/', '_sl_');
SET @Header = REPLACE(@Header, '#', '_sh_');
SET @Header = REPLACE(@Header, '(', '_lp_');
SET @Header = REPLACE(@Header, ')', '_rp_');

-- Split the columns by commas and build the CREATE TABLE script
WITH SplitColumns AS (
    SELECT value AS ColumnName, ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS RowNum
    FROM STRING_SPLIT(@Header, ',')
)
SELECT @Columns = @Columns + '[' + ColumnName + '] VARCHAR(100), '
FROM SplitColumns;

-- Remove the trailing comma
SET @Columns = LEFT(@Columns, LEN(@Columns) - 1);

-- Final CREATE TABLE script
DECLARE @CreateTableScript NVARCHAR(MAX) = 'CREATE TABLE YourTableName (' + @Columns + ');';

-- Output the final CREATE TABLE script
PRINT @CreateTableScript;
